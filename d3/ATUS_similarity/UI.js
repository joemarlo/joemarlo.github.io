// define the 7 modal sequences. These is generated from generate_html.R
let cluster1 = [
  {val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'}
]
let cluster2 = [
  {val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#58df8c'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'}
]
let cluster3 = [
  {val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#966106'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'}
]
let cluster4 = [
  {val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#fd8f2f'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'}
]
let cluster5 = [
  {val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'}
]
let cluster6 = [
  {val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'}
]
let cluster7 = [
  {val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#58df8c'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#b5d08d'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'},{val : '#154e56'}
]
// set 'other' sequence
var clusterOther = cluster3

// create mapping between color values and text
var arrSelect = [
  {val : '#208eb7', text: 'Sports, Exercise, and Recreation'}, {val : '#65e6f9', text: 'Personal Care'}, {val : '#154e56', text: 'Sleep'}, {val : '#58df8c', text: 'Socializing, Relaxing, and Leisure'}, {val : '#966106', text: 'Household Activities'}, {val : '#b5d08d', text: 'Work'}, {val : '#6d3918', text: 'Professional & Personal Care Services'}, {val : '#f24325', text: 'Eating and Drinking'}, {val : '#8e1023', text: 'Caring For Household Member'}, {val : '#c27d92', text: 'Consumer Purchases'}, {val : '#fbcab9', text: 'Other'}, {val : '#ff0087', text: 'Caring For Nonhousehold Members'}, {val : '#fd8f2f', text: 'Education'}, {val : '#bce333', text: 'Volunteer'}, {val : '#798a58', text: 'Religious and Spiritual'}
];

//let tickLabels = ["4am", 5, 6, 7, 8, 9, 10, 11, "12pm", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, "12am", 1, 2, 3]

// function to return cluster based on results from questions
function arrColorsFun(){
  if ($('#Q1').val() == "Yes"){
    Q2 = $('#Q2').val()
    if (Q2 == "Early morning") return cluster6
    if (Q2 == 'Morning') return cluster5
    if (Q2 == 'Afternoon') return cluster7
    if (Q2 == 'Evening') return cluster2
  }

  if ($('#Q3').val() == 'Yes') return cluster4

  Q4 = $('#Q4').val();
  if (Q4 == 'Socializing, relaxation, leisure') return cluster1
  if (Q4 == 'Household activities') return cluster3
  if (Q4 == 'Other') return clusterOther
}

// iterate through and create the select dropdowns
function createInputDropdowns(){
  for (var i=0; i<48; i++){
    var sel = $('<select>').appendTo('#container_user_input');
    sel.addClass("user_input");
    sel.attr('id', 'user_input_'+(i+1))

    // append values to select
    $(arrSelect).each(function() {
      sel.append($("<option>").attr('value',this.val).text(this.text));
    });
  }
}

// update the dropdowns selected values and color
function updateInputDropdowns(arrColors){
  for (var i=0; i<48; i++){
    let sel = $("#user_input_"+(i+1))

    // set default values and colors
    selected_sequence = arrColors[i].val
//    sel.removeAttr("selected")
    sel.val(selected_sequence)
    //$('#user_input_'+ (i+1) + ' option[value="' + selected_sequence + '"]').attr("selected", true);
    sel.css('background-color', selected_sequence)
    sel.css('color', selected_sequence)
  }
}

// initalize dropdowns and question results
createInputDropdowns();
let arrColors = arrColorsFun()
updateInputDropdowns(arrColors);
//updateInputDropdowns(clusterOther);

// add listeners to render next question


// add listeners to each question
let elementsArray = document.querySelectorAll("#container_twenty_questions");
elementsArray.forEach(function(elem) {
  elem.addEventListener("change", function() {
    arrColors = arrColorsFun();
    updateInputDropdowns(arrColors);
  });
});

// add listener to change the color of the dropdown based on its value
$('.user_input').change(function(){
    $(this).css('background-color', $(this).val());
    $(this).css('color', $(this).val());
});
